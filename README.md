## Криптографическая система с использованием алгоритмов AES, HMAC и scrypt для защиты информации (ASHSecurePy)

### Введение

В данном проекте представлена программа шифрования, разработанная с использованием симметричного шифра AES (Advanced Encryption Standard), алгоритма ключевого деривации scrypt и механизма HMAC (Hash-based Message Authentication Code). Эта комбинация технологий обеспечивает надежную защиту конфиденциальности и целостности данных.

### Уникальность программы

Уникальность данной программы заключается в следующем:

1. **Современные криптографические методы**: Программа использует алгоритмы, признанные стандартами в области безопасности, что обеспечивает защиту от современных угроз.
   
2. **Интеграция различных технологий**: Шифрование с использованием AES в режиме CBC, создание ключей с помощью scrypt и проверка целостности данных через HMAC делает программу многоуровневым решением для защиты данных.

3. **Безопасная генерация ключей**: Использование соли и IV (вектора инициализации) при генерации ключей значительно снижает риск атак на основе повторного использования ключей.

### Как работает программа

#### 1. Генерация ключа

Программа использует функцию `generate_key`, которая принимает пароль и случайную соль. С помощью алгоритма scrypt генерируется криптографически стойкий ключ заданной длины (по умолчанию 256 бит).

```python
def generate_key(passphrase, salt, key_length=32):
    return scrypt(passphrase.encode(), salt, key_length, N=2 ** 14, r=8, p=1)
```

#### 2. Дополнение сообщения

Функция `pad_message` добавляет дополнительные байты к исходному сообщению, чтобы его длина стала кратной размеру блока AES (16 байт). Это необходимо для корректного шифрования.

```python
def pad_message(message, block_size):
    padding_len = block_size - len(message) % block_size
    padding = bytes([padding_len] * padding_len)
    return message + padding
```

#### 3. Шифрование сообщения

Метод `encrypt_message` выполняет следующие шаги:

- Генерирует случайную соль и IV.
- Преобразует пароль в ключ с помощью scrypt.
- Дополняет сообщение до нужной длины.
- Шифрует сообщение с использованием AES в режиме CBC.
- Создает HMAC для проверки целостности данных.

```python
def encrypt_message(message, passphrase):
    ...
    hmac = HMAC.new(key, digestmod=SHA256)
    hmac.update(ciphertext)
    return salt + iv + ciphertext + hmac.digest()
```

#### 4. Расшифровка сообщения

Функция `decrypt_message` извлекает соль, IV и HMAC из зашифрованного сообщения, проверяет целостность данных с помощью HMAC и расшифровывает сообщение с использованием AES.

```python
def decrypt_message(encrypted_message, passphrase):
    ...
    hmac.verify(hmac_received)
    ...
    return unpad_message(padded_message)
```

### Пример использования

```python
if __name__ == "__main__":
    message = "Привет, мир!"
    passphrase = "МойПароль"
    
    # Шифруем сообщение.
    encrypted = encrypt_message(message, passphrase)
    print(f"Зашифрованное сообщение: {encrypted}")
    
    # Расшифровываем сообщение.
    decrypted = decrypt_message(encrypted, passphrase)
    print(f"Расшифрованное сообщение: {decrypted.decode('utf-8')}")
```

### Пример вывода

Пример вывода программы будет выглядеть следующим образом (обратите внимание, что зашифрованное сообщение каждый раз будет разным):

```
Зашифрованное сообщение: b'\xf5\x11\xb5A$59$mO#\xafZ\x9c;\x12R\xac\x8c\xed2\xdb\xf8\xf4\xec\xd4"7\x84\xe2\x0e\xfcz(\x97xo\x12\xc6l\xdeq$\x1e:x\xeeTO\x18\x16C7\x12\x1c\x1f\x9e\xf3\xc5\xfa|"(i.n\x97Q~\xe0\xe3\xa5\xe0c\xc1\x91l$\x07\x0cwU\xe6\xd98\xa0e\xd9\x11\x99Os\x84.\xf6Y'
Расшифрованное сообщение: Привет, мир!
```

### Библиотеки

Для работы программы необходимо установить следующие библиотеки:

- `pycryptodome`: для работы с криптографическими алгоритмами.

Вы можете установить необходимую библиотеку с помощью pip:

```bash
pip install pycryptodome
```

### Запуск программы

Чтобы запустить программу, выполните следующие шаги:

1. Скачайте или клонируйте репозиторий с программой.
2. Убедитесь, что у вас установлен Python (рекомендуется версия 3.6 или выше).
3. Установите необходимые библиотеки, как указано выше.
4. Запустите программу с помощью команды:

```bash
python ASHSecurePy.py
```

### Обоснование использования

Программа ориентирована на обеспечение конфиденциальности и целостности данных, что является критически важным в современном цифровом мире. Использование стандартов AES и HMAC обеспечивает высокую степень защиты и соответствует требованиям безопасности, принятым в большинстве организаций.

### Отличия от конкурентов

1. **Сложность алгоритмов**: Программа сочетает в себе несколько криптографических методов, что делает ее более устойчивой к различным типам атак по сравнению с простыми шифрами, использующими только один метод.

2. **Генерация ключей**: Использование алгоритма scrypt для генерации ключей делает программу более защищенной от атак методом перебора (brute force), что является важным преимуществом.

3. **Проверка целостности**: Наличие HMAC обеспечивает защиту от подделки данных, что не всегда встречается в других шифрах, особенно в более простых реализациях.

### Заключение

Разработанная программа шифрования представляет собой надежное решение для защиты данных, которое сочетает в себе современные криптографические методы и принципы безопасности. Уникальные характеристики программы делают ее актуальным инструментом для шифрования информации в различных приложениях.
